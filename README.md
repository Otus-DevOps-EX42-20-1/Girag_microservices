# Girag_microservices

Girag microservices repository

# ДЗ №12: "Технология контейнеризации. Введение в Docker"

- Установлен `Docker`, `docker-compose` и `docker-machine`.
- Создан новый проект на `GCE` и при помощи `docker-machine` создан Docker-хост.
- Написан `Dockerfile`, который будет использоваться для создания образа с нашим приложением `Reddit App`. Предварительно также был подготовлен конфиг БД `mongod.conf`, файл `db_config` с переменной окружения и `start.sh` – скрипт запуска приложения.
- Собран образ на основе подготовленного Докерфайла. Образ успешно загружен на `Docker Hub` в публичный репозиторий `girag/otus-reddit`.

# ДЗ №13: "Docker образы. Микросервисы"

- Приложение было разелено на три компонента:
  - `post-py` – сервис отвечающий за написание постов
  - `comment` – сервис отвечающий за написание комментариев
  - `ui` – веб-интерфейс, работающий с другими сервисами
- Создан `Dockerfile` для каждого из сервисов и собрали образы с ними. Также скачан образ `MongoDB`, необходимый для работы приложения.
- Создан bridge-сеть для контейнеров с сервисами нашего приложения и запущены контейнеры в этой сети с добавлением соответствующих сетевых алиасов к ним.
- Для сервиса `ui` пересобран образ с использованием другого базового образа в `Dockerfile` – это значительно уменьшило его объём.
- Создан `Docker volume` и подключен к контейнеру c `MongoDB`, чтобы данные приложения не пропадали вместе с остановкой контейнера.

# ДЗ №14: "Сетевое взаимодействие Docker контейнеров. Docker Compose. Тестирование образов"

- Опробована работа сети в контейнерах с использованием различных драйверов (`none`, `host` и `bridge`).
- Создан `docker-compose.yml`, содержащий декларативное описание docker-инфраструктуры в YAML-формате для управления многоконтейнерными приложениями, который был параметризирован с помощью переменных окружения.
  Базовое имя проекта по умолчанию формируется из имени текущей директории проекта. Переназначить его можно через флаг `-p` при вызове `docker-compose` или же задав переменную окружения `COMPOSE_PROJECT_NAME` в файле `.env`.

# ДЗ №15: "Устройство Gitlab CI. Построение процесса непрерывной интеграции"

- Развёрнут `Gitlab CI` с помощью `Docker`, подготовлен `docker-compose.yml`.
- Создана группа и проект в `Gitlab`, определён CI/CD pipeline в файле `.gitlab-ci.yml`.
- Запущен и зарегистрирован runner.
- В pipeline добавлен тест приложения и определены окружения `dev`, `stage` и `production`. Также была добавлена поддержка динамических окружений для каждой ветки в репозитории.

# ДЗ №16: "Введение в мониторинг. Модели и принципы работы систем мониторинга"

- Развёрнута система мониторинга `Prometheus` внутри Docker-контейнера.
- Определён простой конфигурационный файл `prometheus.yml` для сбора метрик с наших микросервисов.
- Собраны Docker-образы наших микросервисов при помощи скриптов `docker_build.sh`, а также собран образ самого `Prometheus`.
- Написан `docker-compose.yml` для совместного поднятия всех контейнеров с сервисами, где также прописана секция `networks` для их сетевого взаимодействия.
- Сконфигурирован мониторинг состояния наших микросервисов при помощи нужных endpoint'ов.
- Собранные ранее образы запушены на `Docker Hub` в публичные репозитории:
```
https://hub.docker.com/repository/docker/girag/ui
https://hub.docker.com/repository/docker/girag/comment
https://hub.docker.com/repository/docker/girag/post
https://hub.docker.com/repository/docker/girag/prometheus
```

# ДЗ №17: "Мониторинг приложения и инфраструктуры"

- Файл `docker-compose.yml` разделён на два: в `docker-compose.yml` оставлено описание приложений, а мониторинг выделен в отдельный файл `docker-compose-monitoring.yml`.
- Для наблюдения за состоянием Docker-контейнеров использован `cAdvisor`.
- В файле `prometheus.yml` собрана информация о всех сервисах, с которых собираются метрики.
- Использован инструмент `Grafana` для визуализации данных из `Prometheus`. Создано несколько дашбордов с графиками собираемых метрик приложения.
- Настроен алертинг при помощи `Alertmanager` – дополнительного компонента для системы мониторинга Prometheus, который отвечает за первичную обработку алертов и дальнейшую отправку оповещений по заданному назначению.
- Собранные Docker-образы запушены в публичный репозиторий на Docker Hub:
```
https://hub.docker.com/repository/docker/girag/ui
https://hub.docker.com/repository/docker/girag/comment
https://hub.docker.com/repository/docker/girag/post
https://hub.docker.com/repository/docker/girag/prometheus
https://hub.docker.com/repository/docker/girag/alertmanager
```
